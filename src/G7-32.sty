% This package designed and commented in Russian (utf-8 encoding).
%
% Лицензия GNU GPL v2 и совместимые
%
% Автор - Алексей Томин, с помощью списка рассылки latex-gost-request@ice.ru
% Все вопросы, замечания и пожелания сюда: mailto:alxt@yandex.ru
%
% Дальнейшая разработка и поддержка - Михаил Конник,
% связаться можно по адресу mydebianblog@gmail.com
%
% Further tweaks and development (according to the requirements of
% ГОСТ 7.32-2001 ред. 2009 года.pdf and some other random wishes)
% -- Ivan Zakharyaschev <imz@altlinux.org>.
% Изменено Щегловой Полиной под будущие стандартные нужды.
\ProvidesPackage{G7-32}[2015/11/01 v2.00 Titles for GOST 7.32-2001]

%%%%%%%%%%%%%%%%%%
%Latex 2012 и новее
\newcommand*{\No}{\textnumero}

% ГОСТ 7.32-2001 ред. 2009 года.pdf пункт 6.1.2:
% Полужирный шрифт не применяется
\renewcommand\GostTitleStyle{%
\hyphenpenalty=10000
    \if@usebold%
    \bfseries%
    \else%
    \normalfont%
    \fi%
}%

% ГОСТ 7.32-2001 ред. 2009 года.pdf пункт 6.2.1:
% Заголовки структурных элементов следует располагать в середине
% строки без точки в конце и печатать прописными буквами, не
% подчёркивая.
\renewcommand\Gost@StructChapterStyle{
\hyphenpenalty=10000
    \if@usebold
    \bfseries
    \fi
    \centering\MakeUppercase
}

% Убрать увеличение шрифта в названиях глав
\renewcommand\Gost@MainChapterStyle{%
\hyphenpenalty=10000
    \if@usebold%
    \bfseries%
    \fi%
}%

%стандартные части
\newcommand\Executors{%список исполнителей
 \chapter*{Список~%
           исполнителей}%
}
\newcommand\Referat{%реферат
 \chapter*{Реферат}%
}

\addto\captionsrussian{%
 \def\contentsname{%
  Содержание}%
 \def\bibname{%
  Список~
  использованных~
  источников}%
}
\newcommand\NormRefs{%нормативные ссылки
 \chapter*{Нормативные~%
           ссылки}%
           В настоящем отчете о НИР использованы ссылки на следующие стандарты.
           \vspace{1ex}
}



\newcommand\Introduction{%введение
 \chapter{Введение}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand*\personalSignature[2]{%
  \par\noindent
  \makebox[\textwidth]{%
    \parbox[b]{.4\textwidth}{\raggedright #1}
    \hfill
    \parbox[t]{.25\textwidth}{\ulfill\mbox{}}
    \hfill
    \parbox[t]{.25\textwidth}{\raggedright #2}
  }
}

\newcommand*\ulfill{\mbox{}\leaders\hrule depth 2pt height -1.5pt\hfill} % similar to an underline

\newenvironment*{executors}{%
  \Executors
  % * Руководитель темы
  % * Исполнители:
  % * опционально -- Соисполнители
  % 
  \setlength{\parindent}{0pt}
}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Элементы оформления титульной страницы
% УДК
\newcommand\Nir@UdkName{УДК \makebox[3em]{\ulfill}%
}
\newcommand*\NirUdk[1]{\renewcommand\Nir@UdkName{#1}}% для изменения УДК в тексте документа

% Номер госрегистрации
\newcommand\Nir@No{%
 \No~госрегистрации \makebox[3em]{\ulfill}%
}
\newcommand*\NirGosNo[1]{\renewcommand\Nir@No{#1}}% для изменения номера госрегистрации

% Номер экземпляра
\newcommand\Nir@Ekz{%
    \vspace{-2ex}
}
\newcommand*\NirEkz[1]{\renewcommand\Nir@Ekz{#1}}               %%  для изменения номера

% Гриф
\newcommand\Nir@Grif{\vspace{-2ex}}                          % Гриф секретности
\newcommand*\NirGrif[1]{\renewcommand\Nir@Grif{#1}}             %%  Изменить гриф 

% Утверждающий текст
\newcommand*\Nir@Confirm{%
Утверждаю%
}
\newcommand*\NirConfirm[1]{\renewcommand\Nir@Confirm{#1}}       %%  Изменить утверждающий текст

% Инв. №
\newcommand\Nir@InventarNo{
 Инв.~\No \makebox[3em]{\ulfill}%
}
\newcommand*\NirInventarNo[1]{\renewcommand\Nir@InventarNo{#1}} % Изменить Инв. №

% Наименование организации
\newcommand\Nir@OrgLongName{
    \vspace{1ex}

\hrule
\vspace{1ex}

{\footnotesize предприятие (организация)}
}
\newcommand\NirOrgLongName[1]{\renewcommand\Nir@OrgLongName{#1}}


% Наименование отчета
\newcommand*\Nir@ReportName{%
 Отчёт%
}
\newcommand\NirReportName[1]{\renewcommand\Nir@ReportName{#1}}        % Изменить наименование отчета

% О чем отчет
\newcommand*\Nir@About{
 О{} НАУЧНО-%
 ИССЛЕДОВАТЕЛЬСКОЙ{} %
 РАБОТЕ%
}
\newcommand\NirAbout[1]{\renewcommand\Nir@About{#1}}      % изменить о чем отчет

\newcommand\Nir@AnnOtchet{ %отчёт аннотационный?
}
\newcommand*\NirIsAnnotacion[1]{\renewcommand\Nir@AnnOtchet{#1}} %%Если отчёт аннотационный

\newcommand*\Nir@PartNum{\vspace{-2ex}}     
\newcommand\NirPartNum[2]{\renewcommand\Nir@PartNum{#1 #2}}   

% Год отчета
\newcommand\Nir@Year{\the\year}
\newcommand*\NirYear[1]{\renewcommand\Nir@Year{#1}} % Изменить год отчета

\newcommand\Nir@Town{}
\newcommand*\NirTown[1]{\renewcommand\Nir@Town{#1}}% указываем город написания отчета

\newcommand\Nir@BossStamp{
    \parbox[t]{.49\linewidth}{
        {\centering\MakeUppercase{\Nir@Confirm} % Утверждающий текст 

        }
        \vspace{5mm}
        {\raggedright\Nir@BossPost          % Должность руководителя

        }
        \bigskip
        \ulfill~\Nir@BossName               % Имя руководителя

        \bigskip
        <<\makebox[3em]{\ulfill}>>~\ulfill~\Nir@Year~г. % Подпись
    }
}
\newcommand*\NirBossStamp[1]{\renewcommand\Nir@BossStamp{#1}} % Изменить подпись директора


\newcommand\Nir@BossPost{
    \vspace{3ex}
    \hrule\par \vspace{1ex}
    \centering\footnotesize головной исполнитель
}
\newcommand\Nir@BossName{\makebox[5em]{\ulfill}}

\newcommand*\NirBoss[3][0.49]{
    \renewcommand\Nir@BossPost{#2}\renewcommand\Nir@BossName{#3}
    \renewcommand\Nir@BossStamp{
        \parbox[t]{#1\linewidth}{
            {\centering\MakeUppercase{\Nir@Confirm} % Утверждающий текст 

            }
            \vspace{5mm}
            {\raggedright\Nir@BossPost          % Должность руководителя

            }
            \bigskip
            \ulfill~\Nir@BossName               % Имя руководителя

            \bigskip
            <<\makebox[3em]{\ulfill}>>~\ulfill~\Nir@Year~г. % Подпись
        }
    }
} 

% Подпись научного руководителя
\newcommand\Nir@ManagerStamp{\vspace{-2ex}}
\newcommand\Nir@ManagerPost{
    \vspace{3ex}
    \hrule\par \vspace{1ex}
    \centering\footnotesize научный руководитель НИР
}
\newcommand\Nir@ManagerName{\makebox[5em]{\ulfill}}

\newcommand*\NirManager[3][.49]{
    \renewcommand\Nir@ManagerPost{#2} \renewcommand\Nir@ManagerName{#3}
    \renewcommand\Nir@ManagerStamp{
        \parbox[t]{#1\linewidth}{
            {\raggedright\Nir@ManagerPost

            }
            \bigskip
            \ulfill~\Nir@ManagerName

            \bigskip
            <<\makebox[3em]{\ulfill}>>~\ulfill~\Nir@Year~г.
        }
    }
} 
\newcommand*\NirManagerStamp[1]{\renewcommand\Nir@ManagerStamp{#1}} % Изменить подпись научного руководителя

% Подпись ответственного исполнителя
\newcommand\Nir@IspStamp[1]{\vspace{-2ex}}
\newcommand\Nir@IspPost{
    \vspace{3ex}
\hrule\par
\vspace{1ex}
\centering\footnotesize ответственный исполнитель
}
\newcommand\Nir@IspName{\makebox[5em]{\ulfill}}
\newcommand*\NirIsp[3][0.49]{
    \renewcommand\Nir@IspPost{#2}\renewcommand\Nir@IspName{#3}
    \renewcommand\Nir@IspStamp[1]{
        \parbox[t]{#1\linewidth}{
            {\raggedright\Nir@IspPost

            }
            \bigskip
            \ulfill~\Nir@IspName

            \bigskip
            <<\makebox[3em]{\ulfill}>>~\ulfill~\Nir@Year~г.
        }
    }
} % 
\newcommand*\NirIspStamp[1]{\renewcommand\Nir@IspStamp{#1}}     % Изменить подпись ответственного исполнителя


\newcommand\Nir@Title{\vspace{-2ex}}
\newcommand\Nir[1]{\renewcommand\Nir@Title{#1}}  %Название НИР, не совместимо с \NirTitle  
\newcommand\Nir@TitleAndSubject{
    \vspace{5ex}
\hrule\par\vspace{1ex}
\centering\footnotesize наименование и шифр НИР\par\vspace{5ex}
\hrule
}

%
% Изменить тему отчета:
\newcommand\NirSubject[1]{%
  \renewcommand\Nir@TitleAndSubject{%
    \Nir@Title
    \vspace{1ex}
    \par
    \NirSubjectModifier{#1}%
  }%
}


% По умолчанию "по теме:"
\newcommand\NirSubjectModifier{%
  по~теме:\\
}
%
% Изменить на пустой
\newcommand*\NirBareSubject[1]{%
  \renewcommand\NirSubjectModifier{}%
}

% вид отчёта: "промежуточный" (по умолчанию)
\newcommand\intermediatename{промежуточный}
\newcommand\Nir@StageType{\intermediatename}
% изменить на "заключительный"
\newcommand\@finalname{заключительный}

%Эти команды нужно вызвать для корректного определения титульной страницы

\newcommand*\NirFinal[1][\@finalname]{%
  \renewcommand\Nir@StageType{#1}%
}
\newcommand*\NirFinalStage[2][\@finalname]{%
  \renewcommand\Nir@StageType{#1, #2}%
} % Использование: \NirFinalStage[промежуточный]{этап~3}

\newcommand\finalname[1]{\renewcommand\@finalname{#1}}          % Изменить финальное имя

\newcommand\Nir@Code{шифр\,---\,\makebox[6em]{\ulfill}}
\newcommand*\NirCode[1]{\renewcommand\Nir@Code{#1}} % Изменить код отчета


\RequirePackage{etoolbox}%                                  Для \newrobustcmd
\def\beamer@calltheme#1#2#3{%
    \def\beamer@themelist{#2}%
    \@for\beamer@themename:=\beamer@themelist\do
    {\usepackage[{#1}]{#3\beamer@themename}}}

  \newrobustcmd*\gosttitle[2][]{\beamer@calltheme{#1}{#2}{gosttitle}}

\def\maketitle{\titlepage}



%Title page 
\newenvironment*{titlepage}{}{}

%%%%%%%%%%%%%%%%%%%%%%%
% Макросы совместимости с старыми версиями стилевых пакетов


\RequirePackage{mfirstuc}
\newcommand*\makefirstlc[1]{%
  \renewcommand*\mfirstucMakeUppercase{\MakeLowercase}%
  \makefirstuc{#1}%
  \renewcommand*\mfirstucMakeUppercase{\MakeUppercase}%
}
\newcommand*\xmakefirstlc[1]{%
  \renewcommand*\mfirstucMakeUppercase{\MakeLowercase}%
  \xmakefirstuc{#1}%
  \renewcommand*\mfirstucMakeUppercase{\MakeUppercase}%
}
\newcommand*\emakefirstlc[1]{%
  \renewcommand*\mfirstucMakeUppercase{\MakeLowercase}%
  \emakefirstuc{#1}%
  \renewcommand*\mfirstucMakeUppercase{\MakeUppercase}%
}

\newcommand*\NirStage[3]{%
  \NirSubject{#3}%
  \NirFinalStage[#2]{\emakefirstlc{#1}}%
}

